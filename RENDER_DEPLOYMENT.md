# ðŸš€ Deploy Atlas-NYC to Render.com

This guide will walk you through deploying Atlas-NYC to Render.com's free tier.

## Prerequisites

1. **GitHub Account** - Your code needs to be in a GitHub repository
2. **Render Account** - Sign up at [render.com](https://render.com)
3. **Google Maps API Key** - Your existing key: `AIzaSyCIJcXpuBHBiDhlz2KcfKjkdQn7gYo6iD0`

## Step 1: Push Code to GitHub

```bash
# Initialize git repository (if not already done)
cd /Users/cecilcoleman/nyc-nightlife-api/nyc-nightlife-api/nightlife_project
git init
git add .
git commit -m "Initial Atlas-NYC deployment"

# Create repository on GitHub and push
git remote add origin https://github.com/YOUR_USERNAME/atlas-nyc.git
git branch -M main
git push -u origin main
```

## Step 2: Deploy to Render

### Option A: Using Render.yaml (Recommended)

1. **Connect GitHub Repository**
   - Go to [render.com/dashboard](https://render.com/dashboard)
   - Click "New" â†’ "Blueprint"
   - Connect your GitHub account
   - Select your `atlas-nyc` repository
   - Render will automatically detect the `render.yaml` file

2. **Configure Environment Variables**
   - In the Render dashboard, go to your service
   - Navigate to "Environment" tab
   - Add these variables:
     ```
     GOOGLE_MAPS_API_KEY=AIzaSyCIJcXpuBHBiDhlz2KcfKjkdQn7gYo6iD0
     SECRET_KEY=<auto-generated by Render>
     ENVIRONMENT=production
     ```

### Option B: Manual Setup

1. **Create PostgreSQL Database**
   - Dashboard â†’ "New" â†’ "PostgreSQL"
   - Name: `atlas-nyc-db`
   - Plan: Free
   - Click "Create Database"

2. **Create Web Service**
   - Dashboard â†’ "New" â†’ "Web Service"
   - Connect GitHub repository
   - Configure:
     ```
     Name: atlas-nyc-api
     Environment: Python 3
     Build Command: pip install -r requirements.txt
     Start Command: gunicorn api_server:app -k uvicorn.workers.UvicornWorker --bind 0.0.0.0:$PORT
     ```

3. **Add Environment Variables**
   ```
   DATABASE_URL=<from your PostgreSQL service>
   GOOGLE_MAPS_API_KEY=AIzaSyCIJcXpuBHBiDhlz2KcfKjkdQn7gYo6iD0
   SECRET_KEY=<generate secure key>
   ENVIRONMENT=production
   DEBUG=false
   ALLOWED_ORIGINS=["https://YOUR_SERVICE_NAME.onrender.com"]
   BASE_URL=https://YOUR_SERVICE_NAME.onrender.com
   ```

## Step 3: Initialize Database

Once deployed, you need to initialize the PostgreSQL database:

1. **Access Render Shell**
   - Go to your service dashboard
   - Click "Shell" tab
   - Run: `python init_render_db.py`

2. **Import NYC Venues**
   ```bash
   python import_nyc_venues.py
   ```

3. **Create Admin User**
   ```bash
   python create_admin.py
   ```

## Step 4: Verify Deployment

Visit your deployment URL: `https://YOUR_SERVICE_NAME.onrender.com`

### Test Endpoints:
- **Health Check**: `/health`
- **API Docs**: `/docs`
- **Venues**: `/venues`
- **Mobile Portal**: `/mobile`
- **Public Interface**: `/public`

### Test Google Maps:
- **Geocoding**: `/maps/geocode?address=Times Square, New York`
- **Nearby Places**: `/maps/nearby-places?lat=40.7580&lng=-73.9855&place_type=bar`

## Step 5: Custom Domain (Optional)

1. **Purchase Domain** (e.g., atlas-nyc.com)
2. **Add Custom Domain in Render**
   - Service Settings â†’ Custom Domains
   - Add your domain
   - Update DNS records as instructed
3. **Update Environment Variables**
   ```
   BASE_URL=https://atlas-nyc.com
   ALLOWED_ORIGINS=["https://atlas-nyc.com","https://www.atlas-nyc.com"]
   ```

## Troubleshooting

### Common Issues:

1. **Build Fails**
   - Check `requirements.txt` is in root directory
   - Verify Python version compatibility

2. **Database Connection Error**
   - Ensure `DATABASE_URL` environment variable is set
   - Check PostgreSQL service is running

3. **Google Maps Not Working**
   - Verify `GOOGLE_MAPS_API_KEY` is set correctly
   - Check API key has proper permissions

4. **CORS Errors**
   - Update `ALLOWED_ORIGINS` to include your domain
   - Clear browser cache

### Logs Access:
- Render Dashboard â†’ Your Service â†’ Logs
- Use for debugging deployment issues

## Performance Tips

1. **Enable Auto-Deploy**
   - Automatically deploy when you push to GitHub

2. **Upgrade Plans**
   - Free tier sleeps after inactivity
   - Upgrade to Starter ($7/month) for always-on

3. **Database Optimization**
   - Free PostgreSQL has 1GB limit
   - Monitor usage in Render dashboard

## Security Checklist

- âœ… SECRET_KEY is cryptographically secure
- âœ… API keys are in environment variables
- âœ… Database is not publicly accessible
- âœ… HTTPS is enforced
- âœ… CORS is properly configured

## Cost Estimate

**Free Tier:**
- Web Service: Free (with sleep)
- PostgreSQL: Free (1GB limit)
- **Total: $0/month**

**Production Ready:**
- Web Service: $7/month (Starter)
- PostgreSQL: $7/month (Essential)
- **Total: $14/month**

---

## ðŸŽ‰ You're Live!

Once deployed, your Atlas-NYC API will be accessible at:
`https://YOUR_SERVICE_NAME.onrender.com`

Share this URL to start beta testing with real users!